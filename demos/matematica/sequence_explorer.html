<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Explorador de Progressões</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.2/css/bootstrap.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        .control-group {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .control-group label {
            flex: 1;
            font-size: 0.9rem;
            margin-bottom: 0;
        }
        .control-group input {
            flex: 3;
        }
        .sequence-box {
            display: flex;
            flex-wrap: wrap;
            gap: 5px;
        }
        .sequence-item {
            padding: 5px 10px;
            background-color: #f8f9fa;
            border: 1px solid #ced4da;
            border-radius: 4px;
        }
    </style>
</head>
<body class="bg-light">

<div class="container my-4">
    <div class="card shadow">
        <div class="card-body">
            <h2 class="card-title text-center mb-4">Explorador de Progressões</h2>

            <div class="row g-3">
                <div class="col-lg-6">
                    <div class="control-group">
                        <label for="sequenceType">Tipo de Progressão:</label>
                        <select id="sequenceType" class="form-select">
                            <option value="PA">Progressão Aritmética (PA)</option>
                            <option value="PG">Progressão Geométrica (PG)</option>
                        </select>
                    </div>
                </div>
                <div class="col-lg-6">
                    <div class="control-group">
                        <label for="firstTerm">Primeiro Termo (a₁): <span id="firstTermValue">1</span></label>
                        <input type="range" id="firstTerm" class="form-range" min="1" max="10" step="1" value="1">
                    </div>
                </div>
                <div class="col-lg-6">
                    <div class="control-group">
                        <label for="ratio">Razão (r ou q): <span id="ratioValue">2</span></label>
                        <input type="range" id="ratio" class="form-range" min="0.1" max="5" step="0.1" value="2">
                    </div>
                </div>
                <div class="col-lg-6">
                    <div class="control-group">
                        <label for="terms">Número de Termos: <span id="termsValue">10</span></label>
                        <input type="range" id="terms" class="form-range" min="3" max="20" step="1" value="10">
                    </div>
                </div>
            </div>

            <div class="mt-3">
                <h5>Fórmula do Termo Geral:</h5>
                <p id="formula">aₙ = a₁ + (n-1)×r</p>
            </div>

            <div class="mt-3">
                <h5>Soma dos Termos:</h5>
                <p id="sum">Sₙ = </p>
            </div>

            <div class="mt-3">
                <h5>Termos da Sequência:</h5>
                <div id="sequenceBox" class="sequence-box"></div>
            </div>

            <div class="mt-4">
                <canvas id="sequenceChart" height="100"></canvas>
            </div>
        </div>
    </div>
</div>

<script>
    $(document).ready(function () {
        const sequenceTypeEl = $("#sequenceType");
        const firstTermEl = $("#firstTerm");
        const ratioEl = $("#ratio");
        const termsEl = $("#terms");

        const firstTermValueEl = $("#firstTermValue");
        const ratioValueEl = $("#ratioValue");
        const termsValueEl = $("#termsValue");

        const formulaEl = $("#formula");
        const sumEl = $("#sum");
        const sequenceBoxEl = $("#sequenceBox");
        const chartCanvas = document.getElementById("sequenceChart");

        let chartInstance;

        const updateSequence = () => {
            const type = sequenceTypeEl.val();
            const a1 = parseFloat(firstTermEl.val());
            const r = parseFloat(ratioEl.val());
            const n = parseInt(termsEl.val());

            firstTermValueEl.text(a1);
            ratioValueEl.text(r);
            termsValueEl.text(n);

            let sequence = [];
            let sum = 0;

            for (let i = 1; i <= n; i++) {
                let term;
                if (type === "PA") {
                    term = a1 + (i - 1) * r;
                } else {
                    term = a1 * Math.pow(r, i - 1);
                }
                sequence.push({ n: i, value: term });
                sum += term;
            }

            // Atualizar fórmula e soma
            formulaEl.text(type === "PA"
                ? `aₙ = ${a1} + (n-1)×${r}`
                : `aₙ = ${a1}×${r}^(n-1)`
            );
            sumEl.text(`Sₙ = ${sum.toFixed(2)}`);

            // Atualizar sequência visual
            sequenceBoxEl.html("");
            sequence.forEach(term => {
                sequenceBoxEl.append(`<div class="sequence-item">${term.value.toFixed(1)}</div>`);
            });

            // Atualizar gráfico
            updateChart(sequence);
        };

        const updateChart = (sequence) => {
            const data = {
                labels: sequence.map(item => item.n),
                datasets: [{
                    label: "Valores da Sequência",
                    data: sequence.map(item => item.value),
                    borderColor: "#8884d8",
                    fill: false,
                    tension: 0.1
                }]
            };

            const options = {
                responsive: true,
                scales: {
                    x: {
                        title: { display: true, text: "n-ésimo Termo" }
                    },
                    y: {
                        title: { display: true, text: "Valor" }
                    }
                }
            };

            if (chartInstance) {
                chartInstance.destroy();
            }

            chartInstance = new Chart(chartCanvas, {
                type: "line",
                data,
                options
            });
        };

        // Eventos
        sequenceTypeEl.on("change", updateSequence);
        firstTermEl.on("input", updateSequence);
        ratioEl.on("input", updateSequence);
        termsEl.on("input", updateSequence);

        // Inicializar
        updateSequence();
    });
</script>

</body>
</html>
